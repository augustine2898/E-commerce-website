<%- include("../partials/user/header") %>
<link rel="stylesheet" href="/css/user/wishlist.css">
<div class="hero">
    <div class="container">
        <div class="row justify-content-between">
            <div class="col-lg-5">
                <div class="intro-excerpt">
                    <h1>Wishlist</h1>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="untree_co-section product-section before-footer-section">
    <div class="container">
        <div class="row">
            <!-- <div class="col-lg-12">
                <h2 class="mb-4 section-title text-center">Your Wishlist</h2>
            </div> -->
        </div>
        <% if (wishlist.length > 0) { %>
        <div class="row product__filter">
            <% for (let i = 0; i < wishlist.length; i++) { %>
                <div class="col-6 col-sm-4 col-md-3 mb-4">
                    <div class="product-card">

                        <div class="product-img-action-wrap">
                            <a href="/productDetails?id=<%= wishlist[i]._id %>">
                                <img class="product-image"
                                    src="/uploads/product-image/<%= wishlist[i].productImage[0] %>"
                                    alt="<%= wishlist[i].productName %>">
                            </a>
                        </div>

                        <div class="product-info">
                            <h3>
                                <%= wishlist[i].productName %>
                            </h3>

                            <div class="status-section">
                                <% if (wishlist[i].quantity > 0) { %>
                                    <span class="status available">Available</span>
                                <% } else { %>
                                    <span class="status out-of-stock">Out of Stock</span>
                                <% } %>
                            </div>

                            <div class="price-section">
                                <% if (wishlist[i].salePrice && wishlist[i].regularPrice > wishlist[i].salePrice) { %>
                                    <span class="original-price">₹<%= wishlist[i].regularPrice %></span>
                                    <span class="discounted-price">₹<%= wishlist[i].salePrice %></span>
                                    <span class="discount-percentage">(<%= ((wishlist[i].regularPrice -
                                        wishlist[i].salePrice) / wishlist[i].regularPrice * 100).toFixed(0) %> % OFF)</span>
                                <% } else { %>
                                    <span class="regular-price fw-bold">₹<%= wishlist[i].regularPrice %></span>
                                <% } %>
                            </div>

                            <div class="button-section">
                                <button class="cart-btn" data-product-id="<%= wishlist[i]._id %>">Add to Cart</button>
                                <button class="wishlist-btn" onclick="confirmRemove('<%= wishlist[i]._id %>')">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
            <% } %>
        </div>
        <% } else { %>
        <div class="d-flex flex-column justify-content-center align-items-center" style="height: 70vh;">
            <h1>Your Wishlist</h1>
            <p>Your Wishlist is empty.</p>
            <a href="/shop" class="btn btn-primary">Go to shopping</a>
        </div>
        <% } %>
    </div>
    <div class="pagination-container">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center mb-20">
                <% for (let i=1; i <=totalPages; i++) { %>
                    <li class="page-item <%= (i === currentPage) ? 'active' : '' %>">
                        <a class="page-link" href="?page=<%= i %>">
                            <%= i %>
                        </a>
                    </li>
                    <% } %>
            </ul>
        </nav>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script> const userIsLoggedIn = Boolean(<%= user ? 'true' : 'false' %>);</script>
<script src="/js/user/wishlist.js"></script>
<%- include("../partials/user/footer") %>
