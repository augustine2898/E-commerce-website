<%- include("../partials/user/header")%>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<style>
		.btn:hover {
			background-color: #ff4c4c;
			transform: translateY(-2px);
		}

		.btn:active {
			transform: translateY(1px);
		}


		.product-img-action-wrap {
			position: relative;
		}

		.wishlist-icon {
			position: absolute;
			top: 10px;
			right: 10px;
			z-index: 10;
			/* Ensure it stays above the image */
		}

		.wishlist-icon i {
			font-size: 24px;
			/* Adjust size if needed */
			color: #fff;
			/* White color for the heart */
		}

		.wishlist-icon .filled-heart {
			color: #e74c3c;
			/* Red color for filled heart */
		}

		.wishlist-icon .empty-heart {
			color: #fff;
			/* White color for empty heart */
		}

		/* Optional: Hover effect for the heart */
		.wishlist-icon:hover i {
			transform: scale(1.1);
			/* Slightly increase size on hover */
			transition: transform 0.2s ease-in-out;
		}

		.wishlist-btn {
			background-color: #3b5d50;
			color: white;
			padding: 8px 10px;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			transition: background-color 0.3s ease;
			margin-left: 10px;
		}

		.wishlist-btn:hover {
			background-color: #ff4c4c;
		}

		.wishlist-btn:active {
			transform: translateY(1px);
		}

		.product-img-action-wrap {
			position: relative;
		}

		.product-img {
			position: relative;
			display: block;
			overflow: hidden;
		}

		.product-cart-wrap {
			border: 1px solid #eee;
			padding: 20px;
			margin-bottom: 30px;
		}

		.product-content-wrap h6 {
			font-size: 18px;
			color: #333;
			margin-bottom: 5px;
		}

		.product-content-wrap h5 {
			font-size: 16px;
			color: #ff6b6b;
			margin-bottom: 10px;
		}

		.product-content-wrap a {
			display: inline-block;
			padding: 8px 12px;
			background-color: #ff6b6b;
			color: white;
			text-transform: uppercase;
			font-size: 14px;
			border-radius: 4px;
			text-decoration: none;
		}

		.product-content-wrap a:hover {
			background-color: #ff4c4c;
		}

		.product-img img {
			width: 100%;
			height: 200px;
			object-fit: cover;
			transition: transform 0.3s ease;
		}

		.product-img:hover img {
			transform: scale(1.1);
		}

		.product-cart-wrap {
			display: flex;
			flex-direction: column;
			height: 100%;
			border: 1px solid #e0e0e0;
			padding: 15px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
		}

		.product-content-wrap {
			flex-grow: 1;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.product-content-wrap h6,
		.product-content-wrap h5 {
			margin: 0;
		}

		.product-card {
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			min-height: 400px;
			border: 1px solid #ddd;
			border-radius: 8px;
			overflow: hidden;
			background-color: #fff;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
		}

		.product-image {
			max-height: 200px;
			width: 100%;
			object-fit: cover;
		}

		.product-info {
			padding: 15px;
		}

		h3 {
			font-size: 18px;
			margin: 10px 0;
			color: #333;
			text-align: center;
		}

		.product-size {
			font-size: 14px;
			color: #666;
			text-align: center;
		}

		.price-section {
			margin-top: 10px;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		.discounted-price {
			font-size: 16px;
			color: #d9534f;
			font-weight: bold;
			padding: 4px;
		}

		.original-price {
			font-size: 14px;
			color: #999;
			text-decoration: line-through;
			margin-left: 8px;
			padding: 4px;
		}

		.discount-percentage {
			font-weight: bold;
			color: green;
			margin-left: 10px;
		}

		.cart-btn {
			margin-top: auto;
			padding: 8px 20px;
			font-size: 14px;
			background-color: #0275d8;
			border: none;
			border-radius: 5px;
			color: #fff;
			cursor: pointer;
			transition: background-color 0.3s ease;
		}

		.cart-btn:hover {
			background-color: #025aa5;
		}

		.buttons-wrapper {
			display: flex;
			justify-content: center;
			align-items: center;
			margin-top: 10px;
		}

		@media (max-width: 600px) {
			.product-card {
				max-width: 100%;
			}

			h3 {
				font-size: 16px;
			}

			.price-section {
				flex-direction: column;
			}

			.original-price,
			.discount {
				margin-left: 0;
			}
		}
	</style>

	<!-- End Header/Navigation -->

	<!-- Start Hero Section -->
	<div class="hero">
		<div class="container">
			<div class="row justify-content-between">
				<div class="col-lg-5">
					<div class="intro-excerpt">
						<h1>
							Discover Timeless Designs<span class="d-block">and Modern Comfort</span>
						</h1>
						<p class="mb-4">
							Quality Craftsmanship, Luxurious Comfort, Unbeatable Prices
						</p>
						<p>
							<a href="/shop" class="btn btn-secondary me-2">Shop Now</a>
							<!-- <a href="#" class="btn btn-white-outline">Explore</a> -->
						</p>
					</div>
				</div>
				<div class="col-lg-7">
					<div class="hero-img-wrap">
						<img src="images/couch.png" class="img-fluid">
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Hero Section -->




	<!-- Start Product Section -->
	<div class="product-section">
		<div class="container">
			<div class="row">
				<div class="col-md-12 col-lg-3 mb-5 mb-lg-0">
					<h2 class="mb-4 section-title">Crafted with excellent material.</h2>
					<p class="mb-4"></p>
					<p><a href="/shop" class="btn">Explore</a></p>
				</div>

				<div class="col-lg-12">
					<h2 class="mb-4 section-title text-center">Our Products</h2>
				</div>
			</div>

			<div class="row product__filter">
				<% for (let i=0; i < products.length; i++) { %>
					<div class="col-6 col-sm-4 col-md-3 mb-4">
						<div class="product-card">

							<div class="product-img-action-wrap">
								<span class="wishlist-icon" onclick="toggleWishlist('<%= products[i]._id %>')">
									<% if (wishlistProductIds.includes(products[i]._id.toString())) { %>
										<i class="fas fa-heart filled-heart" id="heart-<%= products[i]._id %>"></i>
										<% } else { %>
											<i class="far fa-heart empty-heart" id="heart-<%= products[i]._id %>"></i>
											<% } %>
								</span>
								<a href="/productDetails?id=<%= products[i]._id %>">
									<img class="product-image"
										src="/uploads/product-image/<%= products[i].productImage[0] %>"
										alt="<%= products[i].productName %>">
								</a>
							</div>


							<div class="product-info">
								<h3>
									<%= products[i].productName %>
								</h3>

								<div class="price-section">
									<% if (products[i].salePrice && products[i].regularPrice> products[i].salePrice) {
										%>
										<span class="original-price">₹<%= products[i].regularPrice %></span>
										<span class="discounted-price">₹<%= products[i].salePrice %></span>
										<span class="discount-percentage">(<%= ((products[i].regularPrice -
												products[i].salePrice) / products[i].regularPrice * 100).toFixed(0) %> %
												OFF)</span>

										<% } else { %>
											<span class="regular-price fw-bold ">₹<%= products[i].regularPrice %></span>
											<% } %>
								</div>


								<div class="button-section">

									<button class="cart-btn" data-product-id="<%= products[i]._id %>">Add to
										Cart</button>


									<button class="wishlist-btn" onclick="addToWishlist('<%= products[i]._id %>')">
										Add to Wishlist
									</button>
								</div>
							</div>
						</div>
					</div>
					<% } %>
			</div>
		</div>
	</div>



	<!-- Start Why Choose Us Section -->
	<div class="why-choose-section">
		<div class="container">
			<div class="row justify-content-between">
				<div class="col-lg-6">
					<h2 class="section-title">Why Choose Us</h2>
					<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate velit
						imperdiet dolor tempor tristique.</p>

					<div class="row my-5">
						<div class="col-6 col-md-6">
							<div class="feature">
								<div class="icon">
									<img src="images/truck.svg" alt="Image" class="imf-fluid">
								</div>
								<h3>Fast &amp; Free Shipping</h3>
								<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam
									vulputate.</p>
							</div>
						</div>

						<div class="col-6 col-md-6">
							<div class="feature">
								<div class="icon">
									<img src="images/bag.svg" alt="Image" class="imf-fluid">
								</div>
								<h3>Easy to Shop</h3>
								<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam
									vulputate.</p>
							</div>
						</div>

						<div class="col-6 col-md-6">
							<div class="feature">
								<div class="icon">
									<img src="images/support.svg" alt="Image" class="imf-fluid">
								</div>
								<h3>24/7 Support</h3>
								<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam
									vulputate.</p>
							</div>
						</div>

						<div class="col-6 col-md-6">
							<div class="feature">
								<div class="icon">
									<img src="images/return.svg" alt="Image" class="imf-fluid">
								</div>
								<h3>Hassle Free Returns</h3>
								<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam
									vulputate.</p>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-5">
					<div class="img-wrap">
						<img src="images/why-choose-us-img.jpg" alt="Image" class="img-fluid">
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Why Choose Us Section -->

	<!-- Start We Help Section -->
	<div class="we-help-section">
		<div class="container">
			<div class="row justify-content-between">
				<div class="col-lg-7 mb-5 mb-lg-0">
					<div class="imgs-grid">
						<div class="grid grid-1"><img src="images/img-grid-1.jpg" alt="Untree.co"></div>
						<div class="grid grid-2"><img src="images/img-grid-2.jpg" alt="Untree.co"></div>
						<div class="grid grid-3"><img src="images/img-grid-3.jpg" alt="Untree.co"></div>
					</div>
				</div>
				<div class="col-lg-5 ps-lg-5">
					<h2 class="section-title mb-4">We Help You Make Modern Interior Design</h2>
					<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate velit
						imperdiet dolor tempor tristique.</p>
					<a href="#" class="btn">Explore Now</a>
				</div>
			</div>
		</div>
	</div>
	<!-- End We Help Section -->

	<!-- Start Blog Section -->
	<div class="blog-section">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<h2 class="section-title">Latest Blogs</h2>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-4 col-md-6 col-12">
					<div class="blog-post mb-4">
						<img src="images/blog-1.jpg" class="img-fluid" alt="">
						<h3>Designing Your Dream Home</h3>
						<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate.</p>
						<a href="#" class="btn">Read More</a>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 col-12">
					<div class="blog-post mb-4">
						<img src="images/blog-2.jpg" class="img-fluid" alt="">
						<h3>Color Trends for 2024</h3>
						<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate.</p>
						<a href="#" class="btn">Read More</a>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 col-12">
					<div class="blog-post mb-4">
						<img src="images/blog-3.jpg" class="img-fluid" alt="">
						<h3>Maximizing Small Spaces</h3>
						<p>Donec vitae odio quis nisl dapibus malesuada. Nullam ac aliquet velit. Aliquam vulputate.</p>
						<a href="#" class="btn">Read More</a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Blog Section -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<%- include("../partials/user/footer") %>
		<script>
			document.querySelectorAll('.cart-btn').forEach(button => {
				button.addEventListener('click', async (event) => {
					const productId = event.target.getAttribute('data-product-id');
					const quantity = 1; // You can change this value based on the input field for quantity, if applicable

					try {
						const response = await fetch('/cart/add/', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
							},
							body: JSON.stringify({ productId, quantity }), // Send quantity here
						});
						const data = await response.json();
						if (data.message === 'Product added to cart') {
							Swal.fire('Success', data.message, 'success');
						} else {
							Swal.fire('Error', data.message || 'Something went wrong. Please try again.', 'error');
						}
					} catch (error) {
						console.error('Error:', error);
						Swal.fire('Error', 'Failed to add product to cart. Please try again.', 'error');
					}
				});
			});


			async function addToWishlist(productId) {
				console.log("Attempting to add to wishlist:", productId)
				$.ajax({

					url: '/addToWishlist',
					method: 'POST',
					data: { productId: productId },
					success: (response) => {
						if (response.status) {

							Swal.fire({
								title: 'Added to wishlist',
								text: 'The product has been added to your wishlist',
								icon: 'success',
								timer: 2000
							}).then(() => {
                    window.location.reload(); 
                });
						} else {
							Swal.fire({
								title: "Already in Wishlist",
								text: response.message,
								icon: 'info',
								timer: 2000,
							})
						}
					},
					error: (error) => {
						Swal.fire({
							title: 'Error',
							text: 'There was an error adding the product to your Wishlist',
							timer: 2000
						})
					}

				})
			}

			
		</script>